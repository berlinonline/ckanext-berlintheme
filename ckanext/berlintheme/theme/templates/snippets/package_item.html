{#
Displays a single of dataset.

package        - A package to display.
item_class     - The class name to use on the list item.
hide_resources - If true hides the resources (default: false).
banner         - If true displays a popular banner (default: false).
truncate       - The length to trucate the description to (default: 180)
truncate_title - The length to truncate the title to (default: 80).

Example:

  {% snippet 'snippets/package_item.html', package=c.datasets[0] %}

#}
{% set truncate = truncate or 180 %}
{% set truncate_title = truncate_title or 80 %}
{% set title = package.title or package.name %}
{% set notes = h.markdown_extract(package.notes, extract_length=truncate) %}

{% block package_item %}
  <li class="{{ item_class or "dataset-item" }}">
    <article class="modul-card">
      {% block content %}
        {% block heading %}
          <header class="card__header">
            <h3 class="title">
              {% block heading_private %}
                {% if package.private %}
                  <span class="dataset-private label label-inverse">
                      <i class="fa fa-lock"></i>
                      {{ _('Private') }}
                  </span>
                {% endif %}
              {% endblock %}
              {% block heading_title %}
      {{ h.link_to(h.truncate(title, truncate_title), h.url_for('%s.read' % package.type, id=package.name)) }}
              {% endblock %}
              {% block heading_meta %}
                {% if package.get('state', '').startswith('draft') %}
                  <span class="label label-info">{{ _('Draft') }}</span>
                {% elif package.get('state', '').startswith('deleted') %}
                  <span class="label label-danger">{{ _('Deleted') }}</span>
                {% endif %}
                {{ h.popular('recent views', package.tracking_summary.recent, min=10) if package.tracking_summary }}
              {% endblock %}
            </h2>
          </header>
        {% endblock heading %}
        <div class="card__body">
          {% block banner %}
            {% if banner %}
              <span class="banner">{{ _('Popular') }}</span>
            {% endif %}
          {% endblock %}
          {% block notes %}
            {% if notes %}
              <div>{{ notes|urlize }}</div>
            {% else %}
              <p class="empty">{{ _("This dataset has no description") }}</p>
            {% endif %}
          {% endblock %}
          {% block resources %}
            {% if package.resources and not hide_resources %}
              {% block resources_outer %}
                <div class="dp-dataset-metadatum dp-dataset-formats">
                  <div class="dp-dataset-metadatum__header">
                    {{ _('Formats') }}:
                  </div>
                  {% block resources_inner %}
                    <div class="dp-resource-icon-list">
                      {% for format in h.berlin_unique_resource_formats(package.resources) %}
                        <div class="dp-resource-icon-mini {{ h.berlin_css_class_for_format_string(format) }}">
                          <div class="dp-resource-icon-label">
                            {{ format | default('(' + _('unknown') + ')', true) }}
                          </div>
                        </div>
                      {% endfor %}
                    </div>
                  {% endblock resources_inner%}
                </div>
              {% endblock resources_outer%}
            {% endif %}
          {% endblock resources %}
        </div>
      {% endblock content%}
    </article>
  </li>
{% endblock package_item %}
